<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Multi-Agent Reinforcement Learning Approach for Connected Autonomous Vehicles">
  <meta name="keywords" content="Reinforcement Learning, CAV">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- <title>AirDet</title> -->

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script> -->
  <link rel="icon" type="image/png" href="./static/images/ai4ce.png"> 
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">
  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/ai4ce.png">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<body>
  <nav class="navbar" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
  </nav>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <!-- <h1 class="title is-1 publication-title"><img src="./static/images/drone.svg" width="120">AirDet&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</h1> -->
            <h1 class="title is-2 publication-title">Safety Guaranteed Robust Multi-Agent Reinforcement Learning with Hierarchical Control for Connected and Automated Vehicles</h1>
            <div class="column is-full_width">
              <h2 class="title is-4">IEEE International Conference on Robotics and Automation (ICRA 2025)</h2>
            </div>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=h-XHPIYAAAAJ&hl=en" target="_blank">Zhili Zhang<sup>1</sup></a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=q5naPLUAAAAJ&hl=en" target="_blank">H M Sabbir Ahmad<sup>2</sup></a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=4ZFF1_sAAAAJ&hl=en" target="_blank">Ehsan Sabouni<sup>2</sup></a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=bloBY_QAAAAJ&hl=en" target="_blank">Yanchao Sun<sup>3</sup></a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=13yyuCcAAAAJ&hl=en" target="_blank">Furong Huang<sup>3</sup></a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=zwA5eokAAAAJ&hl=en" target="_blank">Wenchao Li<sup>2</sup></a>,
              </span>
              <span class="author-block">
                <a href="https://scholar.google.com/citations?user=fH2YF6YAAAAJ&hl=en" target="_blank">Fei Miao<sup>1</sup></a>
              </span>

            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block">1. School of Computing, University of Connecticut</span>
              <span class="author-block">2. Department of Electrical and Computer Engineering, Boston University</span>
              <span class="author-block">3. Department of Computer Science, University of Maryland</span>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
<!--                 <span class="link-block">
                  <a href="https://ieeexplore.ieee.org/abstract/document/10161216" target="_blank"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>Paper</span>
                  </a>
                </span> -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2309.11057" target="_blank"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span>
                <!-- Video Link. -->
                <!-- <span class="link-block">
                  <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fab fa-youtube"></i>
                    </span>
                    <span>Video</span>
                  </a>
                </span> -->
                
                <!-- Code Link. -->
                <!-- <span class="link-block">
                  <a href="https://github.com/zhili-zh/Safe-RMM" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                    </a>
                </span> -->
                
                <!-- Video Link. -->
                <!-- <span class="link-block">
                  <a href="https://www.youtube.com/watch?v=19gaxHapi6o"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fab fa-youtube"></i>
                    </span>
                    <span>Video</span>
                  </a>
                </span> -->
                
                <!-- Dataset Link. -->
                <!-- <span class="link-block">
                  <a href="https://github.com/Jaraxxus-Me/AirDet"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="far fa-images"></i>
                    </span>
                    <span>Data</span>
                  </a>
                </span> -->
                <!-- <span class="link-block">
                  <a href="https://github.com/Jaraxxus-Me/AirDet_ROS"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fas fa-robot"></i>
                    </span>
                    <span>ROS</span>
                  </a>
                </span> -->
                <!-- <span class="link-block">
                  <a href="https://zhuanlan.zhihu.com/p/545249730"
                     class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                        <i class="fas fa-blog"></i>
                    </span>
                    <span>Blog</span>
                  </a>
                </span> -->
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

<!--   <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Video</h2>
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/19gaxHapi6o"
                    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </section> -->

  <section class="hero teaser">
    <div class="container is-max-desktop">
      <div class="hero-body">

        <img src="static\icra25_imgs\cross_combined.jpg" class="center"/>
        <!-- <video id="teaser" autoplay muted loop height="100%">
          <source src="./static/images/SUBT_video.mp4"
                  type="video/mp4">
        </video> -->
        <!-- <img class="rounded" src="./media/nice-slam/teaser.png" > -->
        <br><br><br>
        <!-- <h2 class="subtitle has-text-centered">
          
      </h2> -->
      <!-- <h2 class="subtitle has-text-centered">
        (The <span style="color:#000000;">black</span> / <span style="color:#ff0000;">red</span> lines are the ground truth / predicted camera trajectory)
      </h2> -->
      <h2 class="is-size-6 has-text-centered"><i>Intersection</i> (a): two HDVs run the red light when two CAVs are passing the box in <i>Intersection</i> scenario. CAVs are in green; HDVs are in red. (b): CAVs successfully avoid collision with our method during testing with state uncertainties; (c): CAV1 adopting benchmark (MCP) collides with an HDV because the perturbed location of HDV1 (with yellow triangle) misleads the CAV to believe collision will not happen.</h2>
      
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
          <!-- Paper video. -->
          <!-- <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
              <h2 class="title is-3">Video</h2>
              <div class="publication-video">
                <iframe src="https://www.youtube.com/embed/V5hYTz5os0M?rel=0&amp;showinfo=0"
                        frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
              </div>
            </div>
          </div> -->
          <!--/ Paper video. -->
        
      <!-- <br> -->
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              We address the problem of coordination and control of Connected and Automated Vehicles (CAVs) in the presence of imperfect observations in mixed traffic environment. A commonly used approach is learning-based decision-making, such as reinforcement learning (RL). However, most existing safe RL methods suffer from two limitations: (i) they assume accurate state information, and (ii) safety is generally defined over the expectation of the trajectories. It remains challenging to design optimal coordination between multi-agents while ensuring hard safety constraints under system state uncertainties (e.g., those that arise from noisy sensor measurements, communication, or state estimation methods) at every time step. We propose a safety guaranteed hierarchical coordination and control scheme called Safe-RMM to address the challenge. Specifically, the high-level coordination policy of CAVs in mixed traffic environment is trained by the Robust Multi-Agent Proximal Policy Optimization (RMAPPO) method. Though trained without uncertainty, our method leverages a worst-case Q network to ensure the model's robust performances when state uncertainties are present during testing. The low-level controller is implemented using model predictive control (MPC) with robust Control Barrier Functions (CBFs) to guarantee safety through their forward invariance property. We compare our method with baselines in different road networks in the CARLA simulator. Results show that our method provides the best evaluated safety and efficiency in challenging mixed traffic environments with uncertainties.
            </p>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <!-- <br> -->
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Contribution</h2>
          <div class="content has-text-justified">
            <li>
              We propose a hierarchical decision-making framework, Safe-RMM, for CAVs in mixed traffic environments. The framework comprises of two levels whereby the top level is Robust MARL (the "RM" in Safe-RMM) that determines discrete actions conditioned on the behavior of other CAVs and HDVs. The low-level controller uses MPC (the final "M" in Safe-RMM) with CBFs to execute the high-level plan while guaranteeing safety to the neighborhood vehicles through the forward invariance property of CBFs. 
            </li>
            <li>
              To handle states uncertainties, we design the robust MARL algorithm which only requires training one more critic for the agents but no prior knowledge of uncertainties. Additionally, the MPC controller is incorporated with robust CBFs to consistently generate safe controls given MARL decisions, and to be endowed with the robustness against erroneous system state.
            </li>
            <li>
              We validate through experiments in CARLA simulator that the proposed Safe-RMM approach significantly improves the collision-free rate and allows the CAV agents to achieve higher overall returns compared to baseline methods. Ablation studies further highlight the contributions of both the robust MARL algorithm and the MPC-CBF controller, as well as their reciprocal effects.
            </li>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <!-- Method. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full_width">
          <hr>
          <h2 class="title is-3">Method</h2>
          <br>
          <img src="static\icra25_imgs\Safe-RMM.jpg"/>
          <div class="content has-text-justified">
            <br>  
            <p>
              The figure demonstrates an agent's decision pipeline while other agents share the same procedure. During training, both Value network and worst-Q network join the update of actor's policy. During testing, Agent \( i \)  takes states with uncertainty to its actor and samples the high level action \( a_i \), which is subsequently handled by robust MPC controller for path-planning and generating safe control \( u_i \).
            </p>
          </div>
        </div>
      </div>
      <hr>

      
      <!-- Applications.-->
      <div class="columns is-centered has-text-centered">
        <div class="column is-full_width">
          <h2 class="title is-3">Qualitative&nbsp;&nbsp;Results</h2>
        </div>
      </div>
      <p>
        &nbsp
      </p>
      <!-- <h3 class="title is-4">Attention of Detection Head</h3> -->
      <div class="column is-full_width" style="display: flex; justify-content: center;">
        <img src="static\icra25_imgs\table.jpg" style="width: 600px; height: auto;" alt="Centered Image"/>
        <!-- <div class="content has-text-justified">
          <br>  
          <p>
            We trained our model (GCN-Transformer Constrained Advantage Actor-Critic; 'GT-CA2C' in the table 1, 2), a baseline using our model without <i>Safety Shield</i> ('w/o <i>SS</i>' in tables) and another baseline 'FC-CA2C' with fully-connected layers (replacing GCN-Transformer), constrained advantage actor-critic and <i>Safety Shield</i>, each on <i>Intersection</i> and <i>Highway</i> scenarios. Our method and baselines are all under the multi-agent framework in Alg. 1. Training and testing experiment results are presented in table 1 and 2. We <strong>highlight</strong> our method's top leading performance among all solutions. For each entry in tables, the left percentage is the collision-free rate in simulation; the right number is the mean episode return defined as the mean of agents' sums over stepwise rewards in every episode: \( \sum_{\epsilon=1}^{m} Avg_i {\sum_{t}{r_i^t}}/m \).

          </p>
          </p>
        </div> -->
      </div>
     
  </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Video</h2>
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/ZLd5Mye1f6I?rel=0&amp;showinfo=0"
                    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
          <div class="publication-video">
            <iframe src="https://www.youtube.com/embed/dxoVaRnbZI8?rel=0&amp;showinfo=0"
                    frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>
          </div>
        </div>
      </div>
    </div>
  </section>


  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{zhang2023safety,
        title={Safety Guaranteed Robust Multi-Agent Reinforcement Learning with Hierarchical Control for Connected and Automated Vehicles},
        author={Zhang, Zhili and Ahmad, HM and Sabouni, Ehsan and Sun, Yanchao and Huang, Furong and Li, Wenchao and Miao, Fei},
        journal={arXiv preprint arXiv:2309.11057},
        year={2024}
      }</code></pre>
    </div>
  </section>


  <!-- <section class="section" id="Acknowledgements">
    <div class="container is-max-desktop content">
      <h2 class="title">Acknowledgements</h2>
      The work was done when Bowen Li and Pranay Reddy were interns at The Robotics Institute, CMU. The authors would like to thank all members of the Team Explorer for providing data collected from the DARPA Subterranean Challenge. Our code is built upon <a href="https://github.com/fanq15/FewX">FewX</a>, for which we sincerely express our gratitute to the authors.
    </div>
  </section> -->


  <footer class="footer">
    <div class="container">
      <div class="content has-text-centered">
      </div>
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This website is licensed under a <a rel="license"
                                                  href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
              Commons Attribution-ShareAlike 4.0 International License</a>.
              This webpage template is from <a href="https://github.com/nerfies/nerfies.github.io">Nerfies</a>. 
              We sincerely thank <a href="https://keunhong.com/">Keunhong Park</a> for developing and open-sourcing this template.
            </p>
          </div>
        </div>
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>
</html>
